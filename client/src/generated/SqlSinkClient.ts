// Generated by torii.js CLI
// Service: torii.sinks.sql.SqlSink

import { BaseSinkClient, setSchemaRegistry, type CallOptions } from '@toriijs/sdk';
import type { QueryRequest, QueryResponse, QueryRow, GetSchemaRequest, GetSchemaResponse, SqlSubscribeRequest, SqlOperationUpdate } from './types';
import { QueryRequestSchema, QueryResponseSchema, QueryRowSchema, GetSchemaRequestSchema, GetSchemaResponseSchema, SqlSubscribeRequestSchema, SqlOperationUpdateSchema, schemas } from './schema';

export class SqlSinkClient extends BaseSinkClient {

  constructor(baseUrl: string) {
    super(baseUrl);
    setSchemaRegistry(schemas);
  }

  /**
   * Query - Unary RPC
   */
  async query(
    request: QueryRequest = {} as QueryRequest,
    options?: CallOptions
  ): Promise<QueryResponse> {
    return this.unaryCall<QueryResponse>('/torii.sinks.sql.SqlSink/Query', request as unknown as Record<string, unknown>, { ...options, requestSchema: QueryRequestSchema, responseSchema: QueryResponseSchema });
  }

  /**
   * StreamQuery - Server streaming RPC
   */
  async *streamQuery(
    request: QueryRequest = {} as QueryRequest,
    options?: CallOptions
  ): AsyncGenerator<QueryRow> {
    yield* this.streamCall<QueryRow>('/torii.sinks.sql.SqlSink/StreamQuery', request as unknown as Record<string, unknown>, { ...options, requestSchema: QueryRequestSchema, responseSchema: QueryRowSchema });
  }

  /**
   * StreamQuery with callbacks - Server streaming RPC
   */
  async onStreamQuery(
    request: QueryRequest,
    onMessage: (message: QueryRow) => void,
    onError?: (error: Error) => void,
    onConnected?: () => void
  ): Promise<() => void> {
    return this._subscribeWithCallbacks<QueryRow>('/torii.sinks.sql.SqlSink/StreamQuery', request as unknown as Record<string, unknown>, onMessage, onError, onConnected, QueryRowSchema);
  }

  /**
   * GetSchema - Unary RPC
   */
  async getSchema(
    request: GetSchemaRequest = {} as GetSchemaRequest,
    options?: CallOptions
  ): Promise<GetSchemaResponse> {
    return this.unaryCall<GetSchemaResponse>('/torii.sinks.sql.SqlSink/GetSchema', request as unknown as Record<string, unknown>, { ...options, requestSchema: GetSchemaRequestSchema, responseSchema: GetSchemaResponseSchema });
  }

  /**
   * Subscribe - Server streaming RPC
   */
  async *subscribe(
    request: SqlSubscribeRequest = {} as SqlSubscribeRequest,
    options?: CallOptions
  ): AsyncGenerator<SqlOperationUpdate> {
    yield* this.streamCall<SqlOperationUpdate>('/torii.sinks.sql.SqlSink/Subscribe', request as unknown as Record<string, unknown>, { ...options, requestSchema: SqlSubscribeRequestSchema, responseSchema: SqlOperationUpdateSchema });
  }

  /**
   * Subscribe with callbacks - Server streaming RPC
   */
  async onSubscribe(
    request: SqlSubscribeRequest,
    onMessage: (message: SqlOperationUpdate) => void,
    onError?: (error: Error) => void,
    onConnected?: () => void
  ): Promise<() => void> {
    return this._subscribeWithCallbacks<SqlOperationUpdate>('/torii.sinks.sql.SqlSink/Subscribe', request as unknown as Record<string, unknown>, onMessage, onError, onConnected, SqlOperationUpdateSchema);
  }
}
