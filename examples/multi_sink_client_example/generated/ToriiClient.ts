// Generated by torii.js CLI
// Service: torii.Torii

import { BaseSinkClient, setSchemaRegistry, type CallOptions } from '@toriijs/sdk';
import type { GetVersionRequest, GetVersionResponse, ListTopicsRequest, ListTopicsResponse, SubscriptionRequest, TopicUpdate } from './types';
import { GetVersionRequestSchema, GetVersionResponseSchema, ListTopicsRequestSchema, ListTopicsResponseSchema, SubscriptionRequestSchema, TopicUpdateSchema, schemas } from './schema';

export class ToriiClient extends BaseSinkClient {

  constructor(baseUrl: string) {
    super(baseUrl);
    setSchemaRegistry(schemas);
  }

  /**
   * GetVersion - Unary RPC
   */
  async getVersion(
    request: GetVersionRequest = {} as GetVersionRequest,
    options?: CallOptions
  ): Promise<GetVersionResponse> {
    return this.unaryCall<GetVersionResponse>('/torii.Torii/GetVersion', request as Record<string, unknown>, { ...options, requestSchema: GetVersionRequestSchema, responseSchema: GetVersionResponseSchema });
  }

  /**
   * ListTopics - Unary RPC
   */
  async listTopics(
    request: ListTopicsRequest = {} as ListTopicsRequest,
    options?: CallOptions
  ): Promise<ListTopicsResponse> {
    return this.unaryCall<ListTopicsResponse>('/torii.Torii/ListTopics', request as Record<string, unknown>, { ...options, requestSchema: ListTopicsRequestSchema, responseSchema: ListTopicsResponseSchema });
  }

  /**
   * SubscribeToTopicsStream - Server streaming RPC
   */
  async *subscribeToTopicsStream(
    request: SubscriptionRequest = {} as SubscriptionRequest,
    options?: CallOptions
  ): AsyncGenerator<TopicUpdate> {
    yield* this.streamCall<TopicUpdate>('/torii.Torii/SubscribeToTopicsStream', request as Record<string, unknown>, { ...options, requestSchema: SubscriptionRequestSchema, responseSchema: TopicUpdateSchema });
  }

  /**
   * SubscribeToTopicsStream with callbacks - Server streaming RPC
   */
  async onSubscribeToTopicsStream(
    request: SubscriptionRequest,
    onMessage: (message: TopicUpdate) => void,
    onError?: (error: Error) => void,
    onConnected?: () => void
  ): Promise<() => void> {
    return this._subscribeWithCallbacks<TopicUpdate>('/torii.Torii/SubscribeToTopicsStream', request as Record<string, unknown>, onMessage, onError, onConnected, TopicUpdateSchema);
  }

  /**
   * SubscribeToTopics - Bidirectional streaming RPC (not supported in gRPC-Web)
   */
  subscribeToTopics(): never {
    throw new Error('Bidirectional streaming not supported in gRPC-Web');
  }
}
